<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CBE Data Emergency Scan</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    <style>
        body { font-family: monospace; background: #1a1a1a; color: #00ff00; padding: 20px; }
        .status { background: #333; padding: 10px; border-radius: 5px; margin-bottom: 20px; color: white; }
        .page-box { border: 1px solid #444; padding: 15px; margin-bottom: 20px; background: #000; }
        .line { border-bottom: 1px solid #222; padding: 5px 0; display: block; }
    </style>
</head>
<body>

<div id="status" class="status">Connecting to yoo.pdf...</div>
<div id="output"></div>

<script>
    const PDF_PATH = 'yoo.pdf';
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js';

    async function extractAll() {
        const status = document.getElementById('status');
        const output = document.getElementById('output');

        try {
            const pdf = await pdfjsLib.getDocument(PDF_PATH).promise;
            status.innerText = `‚úÖ Connected. Extracting ${pdf.numPages} pages...`;

            for (let i = 1; i <= pdf.numPages; i++) {
                const page = await pdf.getPage(i);
                const textContent = await page.getTextContent();
                
                let pageHtml = `<div class="page-box"><h3>PAGE ${i}</h3>`;
                
                // Group text by vertical position
                const lines = {};
                textContent.items.forEach(item => {
                    const y = Math.round(item.transform[5]);
                    if (!lines[y]) lines[y] = [];
                    lines[y].push(item.str);
                });

                // Sort and display every single line found
                Object.keys(lines).sort((a, b) => b - a).forEach(y => {
                    const text = lines[y].join(" ").trim();
                    if (text.length > 0) {
                        pageHtml += `<span class="line">${text}</span>`;
                    }
                });

                pageHtml += `</div>`;
                output.innerHTML += pageHtml;
            }
            status.innerText = "üöÄ Scan Complete. If you see text below, we can now format it.";
        } catch (e) {
            status.innerText = "‚ùå Fatal Error: Could not read yoo.pdf. Check the filename capitalization.";
            console.error(e);
        }
    }
    window.onload = extractAll;
</script>
</body>
</html>
